# Мутационное тестирование

## Что такое мутационное тестирование?

Мутационное тестирование - это техника оценки качества тестов путем внесения небольших изменений (мутаций) в исходный код и проверки, обнаруживают ли существующие тесты эти изменения.

## Принцип работы

1. **Создание мутантов** - в код вносятся небольшие изменения (например, `==` меняется на `!=`)
2. **Запуск тестов** - существующие тесты запускаются против мутированного кода
3. **Анализ результатов**:
   - Если тест **провалился** - мутация **обнаружена** ✅ (хорошо)
   - Если тест **прошел** - мутация **НЕ обнаружена** ❌ (плохо)

## Структура мутационных тестов в проекте

```
tests/
├── mutation_test_parity_filter.py      # Мутации для фильтра четности
├── mutation_test_range_filter.py       # Мутации для фильтра диапазона
├── mutation_test_primes_filter.py      # Мутации для фильтра простых чисел
├── mutation_test_digit_sum_filter.py   # Мутации для фильтра суммы цифр
└── run_mutation_tests.py              # Раннер для всех мутационных тестов
```

## Типы мутаций

### 1. Арифметические мутации
- `+` → `-`, `*` → `/`
- `%` → `//`

### 2. Реляционные мутации
- `==` → `!=`
- `<` → `<=`, `>` → `>=`
- `<=` → `<`

### 3. Логические мутации
- `and` → `or`
- Добавление/удаление `not`

### 4. Константные мутации
- `0` → `1`
- `2` → `3`

### 5. Структурные мутации
- Удаление условий
- Перестановка логики
- Возврат неправильных значений

## Примеры мутаций

### Фильтр четности
```python
# Оригинал
if num % 2 == 0:

# Мутации
if num % 2 != 0:     # Изменен оператор сравнения
if num % 3 == 0:     # Изменена константа
if num // 2 == 0:    # Изменен арифметический оператор
```

### Фильтр диапазона
```python
# Оригинал
if min_value <= num <= max_value:

# Мутации
if min_value < num < max_value:      # Убраны границы
if max_value <= num <= min_value:    # Перепутаны границы
if min_value <= num:                 # Убрана верхняя граница
```

### Фильтр простых чисел
```python
# Оригинал
if n < 2:
    return False

# Мутации
if n < 1:            # Изменена граница
if n <= 2:           # Изменен оператор
# (условие удалено)  # Удалено условие
```

## Запуск мутационных тестов

### Запуск всех мутационных тестов
```bash
python tests/run_mutation_tests.py
```

### Запуск отдельного мутационного теста
```bash
python -m unittest tests.mutation_test_parity_filter -v
python -m unittest tests.mutation_test_range_filter -v
python -m unittest tests.mutation_test_primes_filter -v
python -m unittest tests.mutation_test_digit_sum_filter -v
```

## Интерпретация результатов

### ✅ Хорошие результаты
- **Все мутационные тесты прошли** = все мутации обнаружены
- Означает, что основные тесты имеют хорошее покрытие
- Тесты способны обнаружить ошибки в коде

### ❌ Плохие результаты
- **Мутационные тесты провалились** = мутации НЕ обнаружены
- Означает, что основные тесты неполные
- Нужно добавить больше тестовых случаев

### Пример хорошего результата
```
test_mutation_wrong_modulo_operator ... ok
test_mutation_wrong_comparison_operator ... ok
test_mutation_wrong_divisor ... ok

Ran 7 tests in 0.001s
OK
```

### Пример плохого результата
```
test_mutation_wrong_modulo_operator ... FAIL
FAIL: Основные тесты НЕ обнаружили мутацию % -> //
```

## Рекомендации по улучшению тестов

Если мутационные тесты показывают проблемы:

1. **Добавьте граничные случаи**
   - Тестируйте минимальные и максимальные значения
   - Проверяйте поведение на границах диапазонов

2. **Увеличьте разнообразие тестовых данных**
   - Используйте различные комбинации входных данных
   - Тестируйте как положительные, так и отрицательные сценарии

3. **Проверьте все ветки кода**
   - Убедитесь, что каждое условие тестируется
   - Проверьте все возможные пути выполнения

4. **Тестируйте специальные случаи**
   - Пустые списки
   - Одиночные элементы
   - Экстремальные значения

## Автоматизация

Для автоматического запуска мутационных тестов можно использовать:
- CI/CD пайплайны
- Pre-commit хуки
- Регулярные проверки качества кода

Мутационное тестирование помогает убедиться, что ваши тесты действительно проверяют то, что должны проверять!
